"use strict";(self.webpackChunkgamevault_docs=self.webpackChunkgamevault_docs||[]).push([[2199],{80446:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"advanced-usage/authentication","title":"Authentication","description":"GameVault supports two primary authentication methods:","source":"@site/docs/advanced-usage/authentication.md","sourceDirName":"advanced-usage","slug":"/advanced-usage/authentication","permalink":"/docs/advanced-usage/authentication","draft":false,"unlisted":false,"editUrl":"https://github.com/phalcode/gamevault-docs/tree/master/docs/advanced-usage/authentication.md","tags":[],"version":"current","lastUpdatedBy":"Alper Alkan","lastUpdatedAt":1766150541000,"frontMatter":{},"sidebar":"docs","previous":{"title":"REST API Usage","permalink":"/docs/advanced-usage/rest-api"},"next":{"title":"Early Access Program","permalink":"/docs/advanced-usage/early-access-program"}}');var s=i(86070),o=i(9362);const a={},r="Authentication",c={},h=[{value:"Bearer Token (JWT) Authentication",id:"bearer-token-jwt-authentication",level:2},{value:"Generating Tokens",id:"generating-tokens",level:3},{value:"Token Expiration",id:"token-expiration",level:3},{value:"Refreshing Tokens",id:"refreshing-tokens",level:3},{value:"Revoking Tokens",id:"revoking-tokens",level:3},{value:"API-Key Authentication (Machine-to-Machine)",id:"api-key-authentication-machine-to-machine",level:2},{value:"Enabling API Key Support",id:"enabling-api-key-support",level:3},{value:"How to obtain an API Key",id:"how-to-obtain-an-api-key",level:3},{value:"Making Authenticated API Requests",id:"making-authenticated-api-requests",level:3},{value:"Notes",id:"notes",level:3},{value:"Setting Up OAuth2 Authentication (Single Sign-On)",id:"setting-up-oauth2-authentication-single-sign-on",level:2},{value:"Step by Step Guide",id:"step-by-step-guide",level:3},{value:"Examples",id:"examples",level:3},{value:"Google",id:"google",level:4},{value:"Discord",id:"discord",level:4},{value:"Debugging OAuth2 Authentication",id:"debugging-oauth2-authentication",level:3},{value:"Limitations",id:"limitations",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"authentication",children:"Authentication"})}),"\n",(0,s.jsx)(n.p,{children:"GameVault supports two primary authentication methods:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Bearer Token (JWT)"})," - for users logging in interactively. (The GameVault Client uses this method.)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"API-Key"})," - for machine-to-machine and automated use cases."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This page shows you how to authenticate API requests using one of these methods."}),"\n",(0,s.jsxs)(n.p,{children:["Additionally this page provides details on ",(0,s.jsx)(n.a,{href:"#setting-up-oauth2-authentication-single-sign-on",children:"how to set up SSO (Single Sign-On)"})," via OAuth2, which allows users to authenticate using third-party identity providers like Google, Microsoft, Keycloak, etc."]}),"\n",(0,s.jsx)(n.h2,{id:"bearer-token-jwt-authentication",children:"Bearer Token (JWT) Authentication"}),"\n",(0,s.jsxs)(n.p,{children:["JWT is the default method for user-based authentication. Include your access token in the ",(0,s.jsx)(n.code,{children:"Authorization"})," header like so:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-http",children:"Authorization: Bearer <your_access_token>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"generating-tokens",children:"Generating Tokens"}),"\n",(0,s.jsx)(n.p,{children:"You can generate a Bearer token using one of the login endpoints:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Basic Authentication:"}),"\nIf enabled in your ",(0,s.jsx)(n.a,{href:"/docs/server-docs/configuration#auth",children:"server configuration"}),", authenticate via:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-http",children:"POST /api/auth/basic/login\n"})}),"\n",(0,s.jsx)(n.p,{children:"with your username and password. A user needs to be registered first using the registration endpoint."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"OAuth2 Authentication:"}),"\nIf ",(0,s.jsx)(n.a,{href:"#setting-up-oauth2-authentication-single-sign-on",children:"OAuth2"})," is enabled in your ",(0,s.jsx)(n.a,{href:"/docs/server-docs/configuration#auth",children:"server configuration"}),", authenticate via:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-http",children:"GET /api/auth/oauth2/login\n"})}),"\n",(0,s.jsx)(n.p,{children:"through your configured identity provider. This will automatically register the user on the server if they don't already exist."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["On success, both methods return an ",(0,s.jsx)(n.code,{children:"access_token"})," and ",(0,s.jsx)(n.code,{children:"refresh_token"}),". You can use the access token for authenticated requests to the GameVault API. The refresh token can be used to request a new access token when the current one expires."]}),"\n",(0,s.jsx)(n.h3,{id:"token-expiration",children:"Token Expiration"}),"\n",(0,s.jsxs)(n.p,{children:["Generated access tokens are valid for ",(0,s.jsx)(n.strong,{children:"5 minutes"}),", and refresh tokens for ",(0,s.jsx)(n.strong,{children:"30 days"}),". These durations can be adjusted on the ",(0,s.jsx)(n.a,{href:"/docs/server-docs/configuration",children:"Configuration"})," page."]}),"\n",(0,s.jsx)(n.h3,{id:"refreshing-tokens",children:"Refreshing Tokens"}),"\n",(0,s.jsxs)(n.p,{children:["When your access token expires, request a new token pair using your refresh token by calling the ",(0,s.jsx)(n.code,{children:"POST /api/auth/refresh"})," endpoint with your refresh token. Your current refresh token will be invalid after this call so make sure to always use the token received from the response for future token refreshes."]}),"\n",(0,s.jsx)(n.h3,{id:"revoking-tokens",children:"Revoking Tokens"}),"\n",(0,s.jsxs)(n.p,{children:["You can revoke a token by calling the ",(0,s.jsx)(n.code,{children:"POST /api/auth/revoke"})," endpoint with your refresh token. This will effectively log out the user, by blocking future token refreshes."]}),"\n",(0,s.jsx)(n.h2,{id:"api-key-authentication-machine-to-machine",children:"API-Key Authentication (Machine-to-Machine)"}),"\n",(0,s.jsx)(n.p,{children:"GameVault also supports API-key-based authentication. This is perfect for bots, automation, and service-to-service calls, no need for login sessions."}),"\n",(0,s.jsx)(n.h3,{id:"enabling-api-key-support",children:"Enabling API Key Support"}),"\n",(0,s.jsx)(n.p,{children:"To enable API-Key authentication, set the following environment variable:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"AUTH_API_KEY_ENABLED=true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"how-to-obtain-an-api-key",children:"How to obtain an API Key"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Register a user and fetch their API Key"}),"\nRegister a user and use their Bearer token to fetch their API key via:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-http",children:"GET /api/users/me\n"})}),"\n",(0,s.jsx)(n.p,{children:"Example response:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "id": "4",\n  "username": "gvbot_infra",\n  "api_key": "a1b2c3d4e5..." // this is your API key\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{title:"You can hide Bots",type:"tip",children:(0,s.jsxs)(n.p,{children:["You can hide bot accounts from users by prefixing their usernames with ",(0,s.jsx)(n.code,{children:"gvbot_"}),"."]})}),"\n",(0,s.jsx)(n.h3,{id:"making-authenticated-api-requests",children:"Making Authenticated API Requests"}),"\n",(0,s.jsx)(n.p,{children:"Include your API-key in the request headers like so:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-http",children:"X-Api-Key: a1b2c3d4e5...\n"})}),"\n",(0,s.jsx)(n.h3,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["API keys do ",(0,s.jsx)(n.strong,{children:"not expire"}),", handle them carefully"]}),"\n",(0,s.jsxs)(n.li,{children:["API keys currently ",(0,s.jsx)(n.strong,{children:"can not be revoked or changed"})]}),"\n",(0,s.jsxs)(n.li,{children:["API keys are ",(0,s.jsx)(n.strong,{children:"user-bound"})," and inherit that user's permissions."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"setting-up-oauth2-authentication-single-sign-on",children:"Setting Up OAuth2 Authentication (Single Sign-On)"}),"\n",(0,s.jsx)(n.p,{children:"Setting up single sign-on (SSO) using OAuth2 authentication for GameVault requires an identity provider (e.g. Google, Authelia, Keycloak, Microsoft, Discord, etc.)."}),"\n",(0,s.jsx)(n.h3,{id:"step-by-step-guide",children:"Step by Step Guide"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Enable OAuth2 authentication in your ",(0,s.jsx)(n.a,{href:"/docs/server-docs/configuration#auth",children:"configuration"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Create an OAuth2 client in your chosen identity provider."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Add the Authorization URL and Token URL from your identity provider to the ",(0,s.jsx)(n.a,{href:"/docs/server-docs/configuration#auth",children:"Configuration"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Enter your client ID and client secret into the ",(0,s.jsx)(n.a,{href:"/docs/server-docs/configuration#auth",children:"Configuration"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Set the OAuth2 callback URL to your GameVault server URL appended with ",(0,s.jsx)(n.code,{children:"/api/auth/oauth2/login"})," (e.g., ",(0,s.jsx)(n.code,{children:"https://demo.gamevau.lt/api/auth/oauth2/login"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Test the authentication by accessing ",(0,s.jsx)(n.code,{children:"/api/auth/oauth2/login"})," on your GameVault server. You will be redirected to your identity provider's login page. After logging in, you'll return to GameVault, and it will exchange the provided authorization code for an access token. It will automatically register the user using the data from your identity provider if they don't already exist. A successful response looks like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "id": "2",\n  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",\n  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Authentication is now complete. Use the provided access token for authenticated requests to the GameVault API."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(n.p,{children:"You can find working example configurations for popular identity providers below to get an idea of how to set them up."}),"\n",(0,s.jsx)(n.h4,{id:"google",children:"Google"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"AUTH_OAUTH2_CLIENT_ID=XXXXXXXXXXXX-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.apps.googleusercontent.com\nAUTH_OAUTH2_CLIENT_SECRET=XXXXXX-XXXXXXXXXXXX-XXXXXXXXXXXX\nAUTH_OAUTH2_AUTH_URL=https://accounts.google.com/o/oauth2/v2/auth\nAUTH_OAUTH2_TOKEN_URL=https://oauth2.googleapis.com/token\nAUTH_OAUTH2_USERINFO_URL=https://www.googleapis.com/oauth2/v3/userinfo\n"})}),"\n",(0,s.jsx)(n.h4,{id:"discord",children:"Discord"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"AUTH_OAUTH2_CLIENT_ID=XXXXXXXXXXXXXXXXXXXXXXXX\nAUTH_OAUTH2_CLIENT_SECRET=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\nAUTH_OAUTH2_AUTH_URL=https://discord.com/oauth2/authorize\nAUTH_OAUTH2_TOKEN_URL=https://discord.com/api/oauth2/token\nAUTH_OAUTH2_SCOPES=openid,email,identify\nAUTH_OAUTH2_USERINFO_URL=https://discord.com/api/users/@me\n"})}),"\n",(0,s.jsx)(n.h3,{id:"debugging-oauth2-authentication",children:"Debugging OAuth2 Authentication"}),"\n",(0,s.jsxs)(n.p,{children:["You can set the environment variable ",(0,s.jsx)(n.code,{children:"SERVER_LOG_LEVEL"})," environment variable to ",(0,s.jsx)(n.code,{children:"debug"})," to receive detailed logs about the authentication process."]}),"\n",(0,s.jsx)(n.h3,{id:"limitations",children:"Limitations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Without plugins, only one OAuth2 Identity Provider can be used at a time."}),"\n",(0,s.jsxs)(n.li,{children:["The OAuth2 implementation is RFC-compliant but basic (requires ",(0,s.jsx)(n.code,{children:"openid"}),", ",(0,s.jsx)(n.code,{children:"profile"}),", ",(0,s.jsx)(n.code,{children:"email"}),"). Compatibility may vary depending on the identity provider. If you encounter issues using a popular identity provider, please report them on ",(0,s.jsx)(n.a,{href:"https://github.com/Phalcode/gamevault-backend/issues",children:"GitHub"}),". Include details about your identity provider and debug logs in the issue."]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},9362:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var t=i(30758);const s={},o=t.createContext(s);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);